<div 
    x-show="openCart" 
    x-cloak
    @click.away="openCart = false" 
    x-transition:enter="transition ease-out duration-300 transform"
    x-transition:enter-start="translate-x-full"
    x-transition:enter-end="translate-x-0"
    x-transition:leave="transition ease-in duration-300 transform"
    x-transition:leave-start="translate-x-0"
    x-transition:leave-end="translate-x-full"
    class="fixed top-0 right-0 w-80 md:w-96 bg-white shadow-lg z-[100] h-full overflow-hidden"
    data-money-format="{{ shop.money_format }}"
>
    <div class="p-5 flex justify-between items-center bg-[#1D495B] text-white">
        <h2 class="text-lg font-semibold">Your cart</h2>
        <button @click="openCart = false" class="text-white hover:text-gray-300">
            {% render 'icon-close' %}
        </button>
    </div>

    <!-- Contenido del carrito -->
    <div class="p-5">
        <p class="text-sm text-yellow-500">You are eligible for free shipping!</p>
        <div class="mt-4">
            <p>Total: <strong id="cart-drawer-total">{{ cart.total_price | money }}</strong></p>
            <label class="block mt-2">
                <input type="checkbox" class="mr-2"> I have read and agree to the <a href="#" class="text-blue-500">Privacy Policy</a>.
            </label>
            <div class="flex mt-4">
                <button class="bg-yellow-500 text-white px-6 py-2 rounded mr-2 w-full">View cart</button>
                <button class="bg-green-500 text-white px-6 py-2 rounded w-full">Check out</button>
            </div>
        </div>
    </div>

    <!-- Lista de productos en el carrito con scroll -->
    <form id="cart-drawer-form" class="overflow-y-auto p-5 h-[calc(100vh-20rem)]">
        <table class="min-w-full bg-white border rounded-lg">
            <tbody>
                {% for item in cart.items %}
                <tr class="border-b last:border-none" data-key="{{ item.key }}">
                    <!-- Columna del producto -->
                    <td class="py-4">
                        <div class="flex items-center space-x-4">
                            <img src="{{ item.image | img_url: 'small' }}" alt="{{ item.title }}" class="w-16 h-16 object-cover">
                            <div>
                                <h3 class="text-sm">{{ item.product_title }}</h3>
                                <p class="text-sm">{{ item.price | money }}</p>
                            </div>
                        </div>
                    </td>
                    <!-- Columna de la cantidad -->
                    <td class="py-4 text-center">
                        <div class="flex items-center justify-center space-x-2">
                            <button type="button" 
                                    class="w-8 h-8 flex items-center justify-center border border-gray-300 rounded-full text-gray-700 btn-decrease" 
                                    data-key="{{ item.key }}" 
                                    data-stock="{% if item.variant.inventory_management %}{{ item.variant.inventory_quantity }}{% else %}''{% endif %}">
                                <span class="text-lg font-bold leading-none">-</span>
                            </button>
                            <input type="number" 
                                   name="updates[{{ item.key }}]" 
                                   value="{{ item.quantity }}" 
                                   min="1" 
                                   max="{% if item.variant.inventory_management %}{{ item.variant.inventory_quantity }}{% else %}''{% endif %}" 
                                   class="w-10 text-center mx-2 item-quantity" 
                                   data-key="{{ item.key }}">
                            <button type="button" 
                                    class="w-8 h-8 flex items-center justify-center border border-gray-300 rounded-full text-gray-700 btn-increase" 
                                    data-key="{{ item.key }}" 
                                    data-stock="{% if item.variant.inventory_management %}{{ item.variant.inventory_quantity }}{% else %}''{% endif %}">
                                <span class="text-lg font-bold leading-none">+</span>
                            </button>
                        </div>
                    </td>
                    <!-- Columna para eliminar el producto -->
                    <td class="py-4 text-center">
                        <button type="button" class="ml-4 text-red-500 btn-remove" data-key="{{ item.key }}">
                            Remove
                        </button>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </form>
</div>

<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
{{ 'cart-drawer.js' | asset_url | script_tag }}
